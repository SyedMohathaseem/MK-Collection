<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Shop women's fashion at MK Collection. Discover dresses, tops, bottoms, and accessories.">
    <title>Shop All | MK Collection</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/variables.css">
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="css/layout.css">
    <link rel="stylesheet" href="css/pages.css">
</head>
<body>
    <!-- Header (same as index.html) -->
    <header class="header">
        <div class="header-inner">
            <button class="mobile-menu-toggle" aria-label="Menu"><span></span><span></span><span></span></button>
            <a href="index.html" class="logo">MK<span>Collection</span></a>
            <nav class="nav-main">
                <a href="index.html" class="nav-link">New Arrivals</a>
                <!-- Categories Dropdown -->
                <div class="nav-dropdown mega-dropdown">
                    <a href="products.html" class="nav-link">Categories</a>
                    <div class="mega-menu">
                        <div class="mega-menu-inner">
                            <div class="mega-menu-column">
                                <h4>Women</h4>
                                <ul>
                                    <li><a href="products.html?cat=dresses">Dresses</a></li>
                                    <li><a href="products.html?cat=tops">Tops</a></li>
                                    <li><a href="products.html?cat=bottoms">Bottoms</a></li>
                                    <li><a href="products.html?cat=activewear">Activewear</a></li>
                                    <li><a href="products.html?cat=cotton-dresses">Cotton Dresses</a></li>
                                    <li><a href="products.html?cat=readymades">Readymades</a></li>
                                </ul>
                            </div>
                            <div class="mega-menu-column">
                                <h4>Accessories</h4>
                                <ul>
                                    <li><a href="products.html?cat=jewelry">Jewelry</a></li>
                                    <li><a href="products.html?cat=bags">Bags</a></li>
                                    <li><a href="products.html?cat=scarves">Scarves</a></li>
                                </ul>
                            </div>
                            <div class="mega-menu-column">
                                <div class="mega-menu-featured">
                                    <img src="https://images.unsplash.com/photo-1490481651871-ab68de25d43d?w=400&h=300&fit=crop" alt="New Collection">
                                    <div class="mega-menu-featured-content">
                                        <h5>Summer 2026</h5>
                                        <p>Explore the collection</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="nav-dropdown">
                    <a href="products.html" class="nav-link">Collections</a>
                    <div class="nav-dropdown-menu">
                        <a href="products.html?collection=summer-essentials" class="nav-dropdown-item">Summer Essentials</a>
                        <a href="products.html?collection=wedding-guest" class="nav-dropdown-item">Wedding Guest</a>
                        <a href="products.html?collection=office-chic" class="nav-dropdown-item">Office Chic</a>
                    </div>
                </div>
                <a href="products.html?filter=sale" class="nav-link sale">Sale</a>
                <a href="about.html" class="nav-link">About Us</a>
            </nav>
            <div class="header-actions">
                <button class="header-action" data-search-toggle aria-label="Search">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/></svg>
                </button>
                <a href="account.html" class="header-action" aria-label="Account">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/></svg>
                </a>
                <a href="notifications.html" class="header-action" aria-label="Notifications">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"/></svg>
                    <span class="header-action-badge notification-badge" style="display:none">0</span>
                </a>
                <a href="wishlist.html" class="header-action" aria-label="Wishlist">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"/></svg>
                </a>
                <button class="header-action" data-cart-toggle aria-label="Bag">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"/></svg>
                    <span class="header-action-badge" style="display:none">0</span>
                </button>
            </div>
        </div>
    </header>

    <main class="main">
        <div class="products-page">
            <div class="container">
                <!-- Page Header -->
                <div class="page-header">
                    <h1 id="page-title">All Products</h1>
                    <p id="page-description">Discover our complete collection of premium women's fashion</p>
                </div>

                <!-- Breadcrumbs -->
                <nav class="breadcrumbs">
                    <span class="breadcrumb-item"><a href="index.html">Home</a></span>
                    <span class="breadcrumb-separator">/</span>
                    <span class="breadcrumb-item" id="breadcrumb-current">Shop All</span>
                </nav>

                <!-- Filters Bar -->
                <div class="filters-bar">
                    <div class="filters-left">
                        <button class="filter-toggle" id="filter-toggle">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" width="18" height="18"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"/></svg>
                            Filters
                        </button>
                        <span class="results-count"><span id="results-count">0</span> products</span>
                    </div>
                    <div class="filters-right">
                        <select class="sort-select" id="sort-select">
                            <option value="featured">Featured</option>
                            <option value="newest">Newest</option>
                            <option value="price-low">Price: Low to High</option>
                            <option value="price-high">Price: High to Low</option>
                            <option value="rating">Best Rated</option>
                        </select>
                    </div>
                </div>

                <!-- Main Content -->
                <div class="layout-sidebar">
                    <!-- Sidebar Filters -->
                    <aside class="sidebar" id="sidebar-filters">
                        <div class="filter-section">
                            <h4 class="filter-title">Category</h4>
                            <div class="filter-options" id="category-filters">
                                <label class="filter-option"><input type="checkbox" value="dresses"> Dresses</label>
                                <label class="filter-option"><input type="checkbox" value="tops"> Tops</label>
                                <label class="filter-option"><input type="checkbox" value="bottoms"> Bottoms</label>
                                <label class="filter-option"><input type="checkbox" value="activewear"> Activewear</label>
                                <label class="filter-option"><input type="checkbox" value="jewelry"> Jewelry</label>
                            </div>
                        </div>

                        <div class="filter-section">
                            <h4 class="filter-title">Size</h4>
                            <div class="size-options" id="size-filters">
                                <button class="size-option" data-size="XS">XS</button>
                                <button class="size-option" data-size="S">S</button>
                                <button class="size-option" data-size="M">M</button>
                                <button class="size-option" data-size="L">L</button>
                                <button class="size-option" data-size="XL">XL</button>
                            </div>
                        </div>

                        <div class="filter-section">
                            <h4 class="filter-title">Color</h4>
                            <div class="filter-color-options" id="color-filters">
                                <button class="filter-color" style="background:#1A1A1A" data-color="black" title="Black"></button>
                                <button class="filter-color" style="background:#FFFFFF;border:1px solid #ccc" data-color="white" title="White"></button>
                                <button class="filter-color" style="background:#F5B8C9" data-color="pink" title="Pink"></button>
                                <button class="filter-color" style="background:#1E3A5F" data-color="navy" title="Navy"></button>
                                <button class="filter-color" style="background:#7CB342" data-color="green" title="Green"></button>
                                <button class="filter-color" style="background:#E2725B" data-color="terracotta" title="Terra Cotta"></button>
                            </div>
                        </div>

                        <div class="filter-section">
                            <h4 class="filter-title">Price Range</h4>
                            <div class="price-range">
                                <input type="number" class="price-input" id="price-min" placeholder="Min" min="0">
                                <span>—</span>
                                <input type="number" class="price-input" id="price-max" placeholder="Max" min="0">
                            </div>
                        </div>

                        <div class="filter-section">
                            <h4 class="filter-title">Availability</h4>
                            <div class="filter-options">
                                <label class="filter-option"><input type="checkbox" id="filter-sale"> On Sale</label>
                                <label class="filter-option"><input type="checkbox" id="filter-new"> New Arrivals</label>
                            </div>
                        </div>

                        <button class="btn btn-secondary btn-full" id="clear-filters">Clear All Filters</button>
                    </aside>

                    <!-- Products Grid -->
                    <div class="products-content">
                        <div class="products-grid" id="products-grid">
                            <!-- Products rendered by JS -->
                        </div>

                        <!-- Empty State -->
                        <div class="empty-state" id="empty-state" style="display:none;text-align:center;padding:var(--space-16)">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" width="64" height="64" style="margin:0 auto var(--space-4);opacity:0.3"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
                            <h3>No products found</h3>
                            <p style="color:var(--color-gray-500)">Try adjusting your filters or search terms</p>
                            <button class="btn btn-primary" style="margin-top:var(--space-4)" onclick="clearAllFilters()">Clear Filters</button>
                        </div>

                        <!-- Load More -->
                        <div class="text-center" style="margin-top:var(--space-12)" id="load-more-container">
                            <button class="btn btn-secondary" id="load-more">Load More Products</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-grid">
                <div class="footer-brand">
                    <a href="index.html" class="logo" style="color:var(--color-white)">MK<span>Collection</span></a>
                    <p>Premium women's fashion crafted with elegance.</p>
                </div>
                <div class="footer-column"><h4>Shop</h4><ul><li><a href="products.html?filter=new">New</a></li><li><a href="products.html?cat=dresses">Dresses</a></li><li><a href="products.html?filter=sale">Sale</a></li></ul></div>
                <div class="footer-column"><h4>Help</h4><ul><li><a href="#">Contact</a></li><li><a href="#">FAQs</a></li><li><a href="#">Returns</a></li></ul></div>
                <div class="footer-column"><h4>About</h4><ul><li><a href="about.html">Our Story</a></li><li><a href="#">Sustainability</a></li></ul></div>
            </div>
            <div class="footer-bottom">
                <p class="footer-copyright">© MK Collection. All rights reserved.</p>
                <div class="footer-links"><a href="#">Privacy</a><a href="#">Terms</a></div>
            </div>
        </div>
    </footer>

    <!-- Cart Drawer -->
    <div class="cart-drawer-backdrop"></div>
    <div class="cart-drawer">
        <div class="cart-drawer-header"><h3 class="cart-drawer-title">Your Bag</h3><button class="cart-drawer-close btn-ghost"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg></button></div>
        <div class="cart-drawer-body"></div>
        <div class="cart-drawer-footer">
            <div class="cart-shipping-progress"><p class="cart-shipping-text">Add $150 for free shipping</p><div class="progress-bar"><div class="progress-fill" style="width:0%"></div></div></div>
            <div class="cart-subtotal"><span>Subtotal</span><span class="cart-subtotal-value">$0.00</span></div>
            <a href="checkout.html" class="btn btn-primary btn-full">Checkout</a>
        </div>
    </div>

    <!-- Search Modal -->
    <div class="search-modal">
        <div class="search-modal-content">
            <div class="search-header">
                <div class="search-input-wrapper">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" width="20" height="20"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/></svg>
                    <input type="text" class="search-input" placeholder="Search for products...">
                </div>
                <button class="search-close" onclick="document.querySelector('.search-modal').classList.remove('active')">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg>
                </button>
            </div>
            <div class="search-results"></div>
        </div>
    </div>

    <div class="toast-container"></div>

    <script src="js/data.js"></script>
    <script src="js/cart.js"></script>
    <script src="js/wishlist.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/app.js"></script>
    <script>
        let currentFilters = { categories: [], sizes: [], colors: [], minPrice: null, maxPrice: null, sale: false, new: false };
        let currentSort = 'featured';
        let displayedProducts = [];

        document.addEventListener('DOMContentLoaded', () => {
            parseURLParams();
            renderProducts();
            bindFilterEvents();
        });

        function parseURLParams() {
            const params = new URLSearchParams(window.location.search);
            const cat = params.get('cat');
            const collection = params.get('collection');
            const filter = params.get('filter');

            if (cat) {
                currentFilters.categories = [cat];
                document.querySelector(`#category-filters input[value="${cat}"]`)?.click();
                updatePageTitle(cat);
            }
            if (collection) {
                displayedProducts = MKData.getProductsByCollection(collection);
                const coll = MKData.getCollectionById(collection);
                if (coll) updatePageTitle(coll.name, coll.description);
            }
            if (filter === 'sale') {
                currentFilters.sale = true;
                document.getElementById('filter-sale').checked = true;
                updatePageTitle('Sale', 'Amazing deals on selected items');
            }
            if (filter === 'new') {
                currentFilters.new = true;
                document.getElementById('filter-new').checked = true;
                updatePageTitle('New Arrivals', 'The latest additions to our collection');
            }
        }

        function updatePageTitle(title, description) {
            document.getElementById('page-title').textContent = title.charAt(0).toUpperCase() + title.slice(1);
            if (description) document.getElementById('page-description').textContent = description;
            document.getElementById('breadcrumb-current').textContent = title;
        }

        function renderProducts() {
            let products = displayedProducts.length ? displayedProducts : [...MKData.products];

            // Apply filters
            if (currentFilters.categories.length) {
                products = products.filter(p => currentFilters.categories.includes(p.category));
            }
            if (currentFilters.sizes.length) {
                products = products.filter(p => p.sizes.some(s => currentFilters.sizes.includes(s)));
            }
            if (currentFilters.sale) products = products.filter(p => p.isSale);
            if (currentFilters.new) products = products.filter(p => p.isNew);
            if (currentFilters.minPrice) products = products.filter(p => p.price >= currentFilters.minPrice);
            if (currentFilters.maxPrice) products = products.filter(p => p.price <= currentFilters.maxPrice);

            // Sort
            switch (currentSort) {
                case 'newest': products.sort((a, b) => b.isNew - a.isNew); break;
                case 'price-low': products.sort((a, b) => a.price - b.price); break;
                case 'price-high': products.sort((a, b) => b.price - a.price); break;
                case 'rating': products.sort((a, b) => b.rating - a.rating); break;
            }

            const grid = document.getElementById('products-grid');
            const emptyState = document.getElementById('empty-state');
            const loadMore = document.getElementById('load-more-container');

            document.getElementById('results-count').textContent = products.length;

            if (products.length === 0) {
                grid.innerHTML = '';
                emptyState.style.display = 'block';
                loadMore.style.display = 'none';
            } else {
                emptyState.style.display = 'none';
                loadMore.style.display = products.length > 8 ? 'block' : 'none';
                grid.innerHTML = products.slice(0, 12).map(p => MKUI.renderProductCard(p)).join('');
                MKUI.initProductCards();
            }
        }

        function bindFilterEvents() {
            // Category filters
            document.querySelectorAll('#category-filters input').forEach(input => {
                input.addEventListener('change', () => {
                    if (input.checked) currentFilters.categories.push(input.value);
                    else currentFilters.categories = currentFilters.categories.filter(c => c !== input.value);
                    renderProducts();
                });
            });

            // Size filters
            document.querySelectorAll('#size-filters .size-option').forEach(btn => {
                btn.addEventListener('click', () => {
                    btn.classList.toggle('active');
                    const size = btn.dataset.size;
                    if (btn.classList.contains('active')) currentFilters.sizes.push(size);
                    else currentFilters.sizes = currentFilters.sizes.filter(s => s !== size);
                    renderProducts();
                });
            });

            // Color filters
            document.querySelectorAll('#color-filters .filter-color').forEach(btn => {
                btn.addEventListener('click', () => {
                    btn.classList.toggle('active');
                    renderProducts();
                });
            });

            // Sale/New filters
            document.getElementById('filter-sale').addEventListener('change', (e) => {
                currentFilters.sale = e.target.checked;
                renderProducts();
            });
            document.getElementById('filter-new').addEventListener('change', (e) => {
                currentFilters.new = e.target.checked;
                renderProducts();
            });

            // Price filters
            document.getElementById('price-min').addEventListener('change', (e) => {
                currentFilters.minPrice = e.target.value ? parseFloat(e.target.value) : null;
                renderProducts();
            });
            document.getElementById('price-max').addEventListener('change', (e) => {
                currentFilters.maxPrice = e.target.value ? parseFloat(e.target.value) : null;
                renderProducts();
            });

            // Sort
            document.getElementById('sort-select').addEventListener('change', (e) => {
                currentSort = e.target.value;
                renderProducts();
            });

            // Clear filters
            document.getElementById('clear-filters').addEventListener('click', clearAllFilters);
        }

        function clearAllFilters() {
            currentFilters = { categories: [], sizes: [], colors: [], minPrice: null, maxPrice: null, sale: false, new: false };
            displayedProducts = [];
            document.querySelectorAll('#category-filters input').forEach(i => i.checked = false);
            document.querySelectorAll('.size-option.active, .filter-color.active').forEach(b => b.classList.remove('active'));
            document.getElementById('filter-sale').checked = false;
            document.getElementById('filter-new').checked = false;
            document.getElementById('price-min').value = '';
            document.getElementById('price-max').value = '';
            renderProducts();
        }
    </script>
</body>
</html>
