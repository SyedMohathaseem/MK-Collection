<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shopping Bag | MK Collection</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/variables.css">
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="css/layout.css">
    <link rel="stylesheet" href="css/pages.css">
</head>
<body>
    <header class="header">
        <div class="header-inner">
            <button class="mobile-menu-toggle" aria-label="Menu"><span></span><span></span><span></span></button>
            <a href="index.html" class="logo">MK<span>Collection</span></a>
            <nav class="nav-main">
                <a href="products.html?filter=new" class="nav-link">New Arrivals</a>
                <a href="products.html" class="nav-link">Categories</a>
                <a href="products.html?filter=sale" class="nav-link sale">Sale</a>
            </nav>
            <div class="header-actions">
                <a href="account.html" class="header-action"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/></svg></a>
                <a href="wishlist.html" class="header-action"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"/></svg></a>
            </div>
        </div>
    </header>

    <main class="main">
        <div class="cart-page">
            <div class="container">
                <h1 style="margin-bottom:var(--space-8)">Shopping Bag</h1>

                <!-- Empty Cart -->
                <div id="empty-cart" style="display:none;text-align:center;padding:var(--space-16) 0">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" width="80" height="80" style="margin:0 auto var(--space-6);opacity:0.3"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"/></svg>
                    <h2>Your bag is empty</h2>
                    <p style="color:var(--color-gray-500);margin:var(--space-4) 0 var(--space-8)">Looks like you haven't added anything to your bag yet.</p>
                    <a href="products.html" class="btn btn-primary btn-lg">Start Shopping</a>
                </div>

                <!-- Cart Content -->
                <div id="cart-content" class="cart-grid">
                    <div class="cart-items">
                        <div class="cart-items-header">
                            <span>Product</span>
                            <span style="text-align:center">Price</span>
                            <span style="text-align:center">Quantity</span>
                            <span style="text-align:center">Total</span>
                            <span></span>
                        </div>
                        <div id="cart-items-list"></div>
                    </div>

                    <div class="cart-summary">
                        <h2>Order Summary</h2>
                        <div class="cart-summary-row">
                            <span>Subtotal</span>
                            <span id="summary-subtotal">$0.00</span>
                        </div>
                        <div class="cart-summary-row">
                            <span>Shipping</span>
                            <span id="summary-shipping">Calculated at checkout</span>
                        </div>
                        <div class="cart-summary-row">
                            <span>Estimated Tax</span>
                            <span id="summary-tax">$0.00</span>
                        </div>
                        <div class="cart-summary-row total">
                            <span>Total</span>
                            <span id="summary-total">$0.00</span>
                        </div>

                        <div class="cart-promo">
                            <label class="form-label">Promo Code</label>
                            <div class="cart-promo-input">
                                <input type="text" class="form-input" placeholder="Enter code" id="promo-input">
                                <button class="btn btn-secondary" onclick="applyPromo()">Apply</button>
                            </div>
                        </div>

                        <a href="checkout.html" class="btn btn-primary btn-full btn-lg">Proceed to Checkout</a>
                        <a href="products.html" class="btn btn-ghost btn-full" style="margin-top:var(--space-2)">Continue Shopping</a>

                        <div style="margin-top:var(--space-6);padding-top:var(--space-6);border-top:1px solid var(--color-gray-200)">
                            <p style="font-size:var(--text-sm);color:var(--color-gray-500);display:flex;align-items:center;gap:var(--space-2)">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" width="16" height="16"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"/></svg>
                                Secure checkout powered by SSL
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer class="footer">
        <div class="container">
            <div class="footer-bottom">
                <p class="footer-copyright">© MK Collection. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <div class="toast-container"></div>

    <script src="js/data.js"></script>
    <script src="js/cart.js"></script>
    <script src="js/wishlist.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/app.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', renderCart);

        function renderCart() {
            const items = MKCart.getItems();
            const emptyCart = document.getElementById('empty-cart');
            const cartContent = document.getElementById('cart-content');
            const cartList = document.getElementById('cart-items-list');

            if (items.length === 0) {
                emptyCart.style.display = 'block';
                cartContent.style.display = 'none';
                return;
            }

            emptyCart.style.display = 'none';
            cartContent.style.display = 'grid';

            cartList.innerHTML = items.map(item => `
                <div class="cart-line-item" data-item-id="${item.id}">
                    <div class="cart-product">
                        <div class="cart-product-image">
                            <img src="${item.image}" alt="${item.name}">
                        </div>
                        <div class="cart-product-details">
                            <h3>${item.name}</h3>
                            <p class="cart-product-variant">${item.color || ''} ${item.size ? '/ ' + item.size : ''}</p>
                        </div>
                    </div>
                    <div style="text-align:center">
                        <span>$${item.price.toFixed(2)}</span>
                        ${item.originalPrice ? `<br><s style="font-size:var(--text-sm);color:var(--color-gray-400)">$${item.originalPrice.toFixed(2)}</s>` : ''}
                    </div>
                    <div style="display:flex;justify-content:center">
                        <div class="quantity-selector">
                            <button class="quantity-btn" onclick="updateQty('${item.id}', ${item.quantity - 1})">−</button>
                            <span class="quantity-value" style="width:40px;display:flex;align-items:center;justify-content:center">${item.quantity}</span>
                            <button class="quantity-btn" onclick="updateQty('${item.id}', ${item.quantity + 1})">+</button>
                        </div>
                    </div>
                    <div style="text-align:center;font-weight:var(--font-semibold)">$${(item.price * item.quantity).toFixed(2)}</div>
                    <button class="btn-ghost" style="color:var(--color-gray-400)" onclick="removeItem('${item.id}')">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" width="20" height="20"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/></svg>
                    </button>
                </div>
            `).join('');

            updateSummary();
        }

        function updateQty(itemId, qty) {
            if (qty < 1) {
                removeItem(itemId);
            } else {
                MKCart.updateQuantity(itemId, qty);
                renderCart();
            }
        }

        function removeItem(itemId) {
            MKCart.removeItem(itemId);
            MKApp.updateCartBadge();
            renderCart();
            MKApp.showToast('Item removed from bag');
        }

        function updateSummary() {
            const subtotal = MKCart.getSubtotal();
            const shipping = MKCart.getShipping();
            const tax = MKCart.getTax();
            const total = MKCart.getTotal();

            document.getElementById('summary-subtotal').textContent = `$${subtotal.toFixed(2)}`;
            document.getElementById('summary-shipping').textContent = shipping === 0 ? 'FREE' : `$${shipping.toFixed(2)}`;
            document.getElementById('summary-tax').textContent = `$${tax.toFixed(2)}`;
            document.getElementById('summary-total').textContent = `$${total.toFixed(2)}`;
        }

        function applyPromo() {
            const code = document.getElementById('promo-input').value.trim().toUpperCase();
            if (code === 'SAVE10') {
                MKApp.showToast('Promo code applied! 10% off', 'success');
            } else if (code) {
                MKApp.showToast('Invalid promo code', 'error');
            }
        }
    </script>
</body>
</html>
