<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image Upload | MK Collection Admin</title>
    <base href="/admin/">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../css/variables.css">
    <link rel="stylesheet" href="../css/base.css">
    <link rel="stylesheet" href="../css/components.css">
    <link rel="stylesheet" href="css/admin.css">
</head>
<body>
    <div class="admin-layout">
        <!-- Sidebar -->
        <aside class="admin-sidebar">
            <div class="admin-sidebar-header">
                <a href="index.html" class="admin-logo">MK<span>Admin</span></a>
            </div>
            <nav class="admin-nav">
                <div class="admin-nav-section">
                    <p class="admin-nav-title">Overview</p>
                    <a href="index.html" class="admin-nav-link">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/></svg>
                        Dashboard
                    </a>
                    <a href="orders.html" class="admin-nav-link">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"/></svg>
                        Orders
                    </a>
                </div>
                <div class="admin-nav-section">
                    <p class="admin-nav-title">Catalog</p>
                    <a href="products.html" class="admin-nav-link">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"/></svg>
                        Products
                    </a>
                    <a href="inventory.html" class="admin-nav-link">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"/></svg>
                        Inventory
                    </a>
                    <a href="upload.html" class="admin-nav-link active">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"/></svg>
                        Image Upload
                    </a>
                </div>
                <div class="admin-nav-section">
                    <p class="admin-nav-title">Settings</p>
                    <a href="settings.html" class="admin-nav-link">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/></svg>
                        Settings
                    </a>
                    <a href="../index.html" class="admin-nav-link">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"/></svg>
                        View Store
                    </a>
                </div>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="admin-main">
            <header class="admin-header">
                <button class="admin-mobile-toggle">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/></svg>
                </button>
                <h1 class="admin-page-title">Bulk Image Upload</h1>
                <div class="admin-header-right">
                    <button class="btn btn-secondary" onclick="viewMediaLibrary()">Media Library</button>
                </div>
            </header>


            <div class="admin-content">
                <!-- Upload Zone -->
                <div class="chart-card">
                    <div class="chart-header">
                        <h3 class="chart-title">Upload Images</h3>
                    </div>
                    
                    <div class="upload-zone" id="upload-zone">
                        <input type="file" id="file-input" multiple accept="image/*" style="display:none">
                        <div class="upload-zone-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" width="64" height="64"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"/></svg>
                        </div>
                        <p class="upload-zone-text">Drag & drop images here or click to browse</p>
                        <p class="upload-zone-hint">Supports: JPG, PNG, WebP • Max size: 10MB per file</p>
                        <button class="btn btn-primary" style="margin-top:var(--space-4)" onclick="document.getElementById('file-input').click()">Select Files</button>
                    </div>
                </div>

                <!-- Assign to Product -->
                <div class="chart-card">
                    <div class="chart-header">
                        <h3 class="chart-title">Assign to Product</h3>
                    </div>
                    <div style="display:grid;grid-template-columns:1fr 1fr;gap:var(--space-6)">
                        <div class="form-group">
                            <label class="form-label">Select Product</label>
                            <select class="form-input form-select" id="product-select">
                                <option value="">-- Select a product --</option>
                                <option value="prod-001">Elegant Blush Midi Dress</option>
                                <option value="prod-002">Classic White Linen Blouse</option>
                                <option value="prod-003">High-Waist Tailored Trousers</option>
                                <option value="prod-004">Summer Floral Maxi Dress</option>
                                <option value="prod-005">Athleisure Yoga Set</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Color Variant (Optional)</label>
                            <select class="form-input form-select" id="color-select">
                                <option value="">-- All colors --</option>
                                <option value="black">Black</option>
                                <option value="white">White</option>
                                <option value="blush-pink">Blush Pink</option>
                                <option value="navy">Navy</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Uploaded Images Preview -->
                <div class="chart-card" id="preview-section" style="display:none">
                    <div class="chart-header">
                        <h3 class="chart-title">Uploaded Images</h3>
                        <div>
                            <button class="btn btn-secondary btn-sm" onclick="clearUploads()">Clear All</button>
                            <button class="btn btn-primary btn-sm" onclick="saveImages()">Save Images</button>
                        </div>
                    </div>
                    <div id="preview-grid" style="display:grid;grid-template-columns:repeat(auto-fill, minmax(150px, 1fr));gap:var(--space-4)"></div>
                </div>

                <!-- Recent Uploads -->
                <div class="chart-card">
                    <div class="chart-header">
                        <h3 class="chart-title">Recent Uploads</h3>
                        <a href="#" class="btn btn-ghost btn-sm">View All</a>
                    </div>
                    <div style="display:grid;grid-template-columns:repeat(auto-fill, minmax(200px, 1fr));gap:var(--space-4)">
                        <div style="position:relative;aspect-ratio:4/3;border-radius:var(--radius-lg);overflow:hidden;background:var(--color-gray-100)">
                            <img src="https://images.unsplash.com/photo-1595777457583-95e059d581b8?w=300&h=200&fit=crop" alt="Recent upload" style="width:100%;height:100%;object-fit:cover">
                            <div style="position:absolute;bottom:0;left:0;right:0;padding:var(--space-2);background:linear-gradient(transparent, rgba(0,0,0,0.7));color:white;font-size:var(--text-xs)">
                                <p style="margin:0">Elegant Blush Midi Dress</p>
                                <p style="margin:0;opacity:0.7">Today, 10:30 AM</p>
                            </div>
                        </div>
                        <div style="position:relative;aspect-ratio:4/3;border-radius:var(--radius-lg);overflow:hidden;background:var(--color-gray-100)">
                            <img src="https://images.unsplash.com/photo-1564257631407-4deb1f99d992?w=300&h=200&fit=crop" alt="Recent upload" style="width:100%;height:100%;object-fit:cover">
                            <div style="position:absolute;bottom:0;left:0;right:0;padding:var(--space-2);background:linear-gradient(transparent, rgba(0,0,0,0.7));color:white;font-size:var(--text-xs)">
                                <p style="margin:0">Classic White Blouse</p>
                                <p style="margin:0;opacity:0.7">Today, 9:15 AM</p>
                            </div>
                        </div>
                        <div style="position:relative;aspect-ratio:4/3;border-radius:var(--radius-lg);overflow:hidden;background:var(--color-gray-100)">
                            <img src="https://images.unsplash.com/photo-1594633312681-425c7b97ccd1?w=300&h=200&fit=crop" alt="Recent upload" style="width:100%;height:100%;object-fit:cover">
                            <div style="position:absolute;bottom:0;left:0;right:0;padding:var(--space-2);background:linear-gradient(transparent, rgba(0,0,0,0.7));color:white;font-size:var(--text-xs)">
                                <p style="margin:0">Tailored Trousers</p>
                                <p style="margin:0;opacity:0.7">Yesterday, 3:45 PM</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <div class="toast-container"></div>

    <script src="../js/data.js"></script>
    <script src="../js/store.js"></script>
    <script src="js/admin.js"></script>
    <script>
        const uploadZone = document.getElementById('upload-zone');
        const fileInput = document.getElementById('file-input');
        const previewSection = document.getElementById('preview-section');
        const previewGrid = document.getElementById('preview-grid');
        let uploadedFiles = [];

        // Drag and drop
        uploadZone.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadZone.classList.add('dragover');
        });

        uploadZone.addEventListener('dragleave', () => {
            uploadZone.classList.remove('dragover');
        });

        uploadZone.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadZone.classList.remove('dragover');
            handleFiles(e.dataTransfer.files);
        });

        uploadZone.addEventListener('click', () => {
            fileInput.click();
        });

        fileInput.addEventListener('change', () => {
            handleFiles(fileInput.files);
        });

        function handleFiles(files) {
            if (files.length === 0) return;

            for (const file of files) {
                if (!file.type.startsWith('image/')) {
                    MKAdmin.showToast(`${file.name} is not an image`, 'error');
                    continue;
                }
                if (file.size > 10 * 1024 * 1024) {
                    MKAdmin.showToast(`${file.name} is too large (max 10MB)`, 'error');
                    continue;
                }
                uploadedFiles.push(file);
            }

            renderPreviews();
            MKAdmin.showToast(`${files.length} image(s) added`, 'success');
        }

        function renderPreviews() {
            if (uploadedFiles.length === 0) {
                previewSection.style.display = 'none';
                return;
            }

            previewSection.style.display = 'block';
            previewGrid.innerHTML = uploadedFiles.map((file, index) => `
                <div style="position:relative;aspect-ratio:1;border-radius:var(--radius-lg);overflow:hidden;background:var(--color-gray-100);border:1px solid var(--color-gray-200)">
                    <img src="${URL.createObjectURL(file)}" alt="${file.name}" style="width:100%;height:100%;object-fit:cover">
                    <button onclick="removeFile(${index})" style="position:absolute;top:var(--space-2);right:var(--space-2);width:24px;height:24px;border-radius:var(--radius-full);background:rgba(0,0,0,0.6);color:white;border:none;cursor:pointer;display:flex;align-items:center;justify-content:center">×</button>
                    <div style="position:absolute;bottom:0;left:0;right:0;padding:var(--space-2);background:rgba(255,255,255,0.9);font-size:var(--text-xs)">
                        <p style="margin:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap">${file.name}</p>
                        <p style="margin:0;color:var(--color-gray-500)">${(file.size / 1024).toFixed(1)} KB</p>
                    </div>
                    <div style="position:absolute;top:var(--space-2);left:var(--space-2);padding:2px 6px;font-size:10px;background:#10B981;color:white;border-radius:var(--radius-sm)">✓ Quality OK</div>
                </div>
            `).join('');
        }

        function removeFile(index) {
            uploadedFiles.splice(index, 1);
            renderPreviews();
        }

        function clearUploads() {
            uploadedFiles = [];
            renderPreviews();
            fileInput.value = '';
        }

        function saveImages() {
            const product = document.getElementById('product-select').value;
            if (!product) {
                MKAdmin.showToast('Please select a product', 'error');
                return;
            }
            if (uploadedFiles.length === 0) {
                MKAdmin.showToast('No images to save', 'error');
                return;
            }

            MKAdmin.showToast(`Saving ${uploadedFiles.length} images...`, 'default');
            
            setTimeout(() => {
                MKAdmin.showToast('Images saved successfully!', 'success');
                clearUploads();
            }, 1500);
        }

        function viewMediaLibrary() {
            MKAdmin.showToast('Opening media library...', 'default');
        }
    </script>
</body>
</html>
